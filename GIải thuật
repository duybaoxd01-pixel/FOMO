import cv2
import numpy as np
import tflite_runtime.interpreter as tflite

model = tflite.Interpreter(model_path="fomo_model.tflite")
model.allocate_tensors()

input_details = model.get_input_details()
output_details = model.get_output_details()

# Đọc ảnh mẫu
img = cv2.imread("test_img.jpg")
img_resized = cv2.resize(img, (96, 96))
img_norm = np.expand_dims(img_resized.astype(np.float32) / 255.0, axis=0)

# Chạy mô hình
model.set_tensor(input_details[0]['index'], img_norm)
model.invoke()
output = model.get_tensor(output_details[0]['index'])

# Hiển thị heatmap từng lớp
heatmap = np.squeeze(output)
for i in range(heatmap.shape[-1]):
    cv2.imshow(f"Class {i}", heatmap[:, :, i])

cv2.waitKey(0)
